#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
#  heat_exhanger.py
#  
#  Copyright 2020 Kristian Farkas <farkas@farkas>
#  
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.
#  
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#  
#  You should have received a copy of the GNU General Public License
#  along with this program; if not, write to the Free Software
#  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
#  MA 02110-1301, USA.
#  
#  

import numpy as np
import salome
salome.salome_init()
import GEOM
from salome.geom import geomBuilder
geompy = geomBuilder.New(salome.myStudy)
gg = salome.ImportComponentGUI("GEOM")

radius = 2.97
r_c = 0.3
h_c = 6
radius_c = 20
height = 500
radius_c_s = 5


cylinder = geompy.MakeCylinderRH(radius_c, height)
cylinder_small = geompy.MakeCylinderRH(radius_c_s, height)


arr = np.array([[  1.67125622,  -7.8234882 ,   7.95986178],
       [ -4.3057871 , -16.44566979,   5.94658009],
       [ 11.8620403 ,  12.17752041,   8.2868275 ],
       [ 11.73970559, -12.29549696,   3.        ],
       [ 10.78044553,  -7.13176491,   7.18037295],
       [  8.62117414, -14.65180552,  14.32550003],
       [  3.61456488,  -7.13686467,  15.6786228 ],
       [ 15.35372183,   7.29816363,   8.28821361],
       [ -1.77173227,  16.90742293,   2.99999842],
       [-11.4884543 ,   7.98218325,   8.53871411],
       [  7.06450122,   3.75627157,   9.44244554],
       [ -7.7415133 ,  -2.01708643,   2.99997758],
       [  8.180618  ,   7.75464951,  13.80708608],
       [  6.16408739, -15.84311768,   8.96791969],
       [ 12.86807637,   4.12911162,  12.86740437],
       [ -7.54889698,  15.23203519,   2.99998302],
       [  4.21230051,  16.46987254,   2.99999897],
       [ 12.29325531,   2.33894851,   6.86007244],
       [  0.89518832, -16.97641445,   3.        ],
       [ -3.78947373,   7.14300723,  13.59391026],
       [ -6.41463757,   4.78042051,  18.55069553],
       [ 11.91031192,  -1.77888397,  12.26062304],
       [ 16.23026496,  -5.05752891,   8.59333012],
       [  9.63536073,  -6.41385064,  15.31703692],
       [  7.70339383,   2.15791895,   2.99998372],
       [ 11.27688098, -12.72135431,   9.3035465 ],
       [ -3.01908027, -11.3799347 ,   2.99998956],
       [ -4.1299476 ,  -6.85150065,   6.77609971],
       [-16.95341113,  -1.25770536,  19.53144718],
       [ 16.44654381,   4.30239018,   2.99999997],
       [-14.61706738,  -8.67993573,   2.99997352],
       [-10.02830201,   9.7683386 ,   2.99999327],
       [  5.02269578, -12.2507544 ,  18.48310629],
       [-13.30365665,  -6.26844524,   9.91829197],
       [ -4.49078755,  16.39612108,   8.32402814],
       [-16.03183261,   5.65511651,  15.99421782],
       [ -3.12919191,  -7.36261898,  13.88249446],
       [ -7.98369105,   0.51055299,  14.63838405],
       [-16.31802697,   4.76680302,  10.06725706],
       [  9.67161398,  13.98069671,   2.99999891],
       [  6.65362643,  -9.27892064,  10.96955585],
       [  2.18499271,   7.69583061,  13.5859831 ],
       [-16.94697504,   1.3425533 ,   2.99997705],
       [  6.73706472, -15.60807988,   2.99998973],
       [ -3.28616088,  11.01018088,   2.99999997],
       [  5.70751108,  -5.60573823,   3.        ],
       [  8.14722072,   8.1412065 ,   2.99999997],
       [ 16.91678222,  -1.6789694 ,   2.99999998],
       [-16.95709662,  -1.20708254,   9.22750983],
       [  2.9649046 , -10.94219321,   3.        ],
       [ -7.53696626,  -2.68218524,  19.69870163],
       [ -8.66223576,  -7.94598955,   2.99997378],
       [ -5.76500836,   5.54653762,   2.99999996],
       [ -2.92529298, -11.95348622,   9.69453576],
       [ -7.36047008,  15.32394817,  13.48303517],
       [ 16.98672304,   0.67204506,  10.20559811],
       [  0.32468059, -16.9968931 ,   9.72209765],
       [-12.31035328, -11.72412973,   7.62725827],
       [ -3.70259102, -16.59188926,  14.15116005],
       [ -7.64243428,  -3.07028432,   9.83621195],
       [  6.16173294,   9.60753737,   8.46908047],
       [ 16.50943786,  -4.05443831,  15.50046372],
       [ -7.57242693,  10.45504375,  16.982859  ],
       [-11.55129759,   1.35760375,   8.78069284],
       [-13.96447423,   0.31574101,  14.19994656],
       [  7.82747297,   1.65247311,  15.00947987],
       [-12.47699595,  11.5466284 ,  13.26647895],
       [ -8.07185302, -14.96144604,  10.37584618],
       [-16.18672605,  -5.19515853,  15.06956201],
       [ 13.92755096,   9.74779375,   2.99999562],
       [ 14.43651983,  -8.97701706,  12.76713348],
       [ -8.02559453,  -8.97767107,  10.81382358],
       [-13.35408483,  -3.10425045,   4.82083444],
       [  2.70333359,  10.66289136,   2.99999843],
       [  1.57275094, -16.92707595,  16.98988258],
       [-13.5816345 ,  10.22444138,  19.01378346],
       [ -2.03700782, -11.95916951,  17.5809897 ],
       [ -9.95740314,  13.77861176,   8.29962558],
       [ -6.52362641,   4.63057657,   8.88094327],
       [ -1.05781983,  10.25182691,  17.93925947],
       [-15.4249899 ,   7.14628414,   3.        ],
       [-11.15716839,   2.91575186,   2.99999045],
       [ 11.02958207,  -2.83541693,   2.99992164],
       [ -3.54963885,  16.62528388,  17.93096005],
       [ -8.89258768, -14.48868115,  16.30523744],
       [ 13.72905649,  10.02561693,  13.56731481],
       [  7.74183567,  -2.01593629,   7.95160934],
       [ -4.99624093,  10.43072628,   8.72208749],
       [-14.09149315,  -9.50945966,  19.26727187],
       [  1.97407908, -12.34633822,  13.13564619],
       [-11.9547322 ,   2.62374511,  19.36076173],
       [ 15.27997932,  -7.45133547,   3.        ],
       [-10.17978744,  -5.17242588,  14.9222936 ],
       [ -8.89344566, -13.94150993,   2.99999657],
       [-12.94948488, -11.01411661,  13.57239039],
       [ -1.70028906,  13.31727169,  12.82142327],
       [  6.82755214,  15.56870414,   8.32431602],
       [  0.41630528,   7.98916117,   7.86010585],
       [-10.35078963,   5.99602419,  14.08495772],
       [  1.03774526,  14.19514744,   7.55525763]])


for u in range(len(arr)):
		u = geompy.MakeVertex(arr[u][0], arr[u][1], arr[u][2])
		sphere1 = geompy.MakeSpherePntR(u, radius)
		geompy.addToStudy(sphere1,"Sphere" + str(u))
	


coord_of_cylinders = np.array([[[  4.32426408e+00,   1.24525793e+00,   3.87588492e+01],
        [  7.54354997e-01,   4.49717972e+00,   4.00551870e+01]],

       [[  4.32426408e+00,   1.24525793e+00,   3.87588492e+01],
        [  6.95409079e+00,  -2.80907919e+00,   3.74759763e+01]],

       [[  4.32426408e+00,   1.24525793e+00,   3.87588492e+01],
        [  4.60570450e+00,   5.91926625e+00,   3.70055815e+01]],

       [[  4.32426408e+00,   1.24525793e+00,   3.87588492e+01],
        [  7.48045093e+00,   5.41201916e-01,   4.25723314e+01]],

       [[  4.07745958e+00,   1.90359936e+00,   1.76556549e+01],
        [  6.37239450e+00,   3.95516590e+00,   2.15955017e+01]],

       [[  4.07745958e+00,   1.90359936e+00,   1.76556549e+01],
        [  3.14760651e+00,   6.80754125e+00,   1.79499152e+01]],

       [[  4.07745958e+00,   1.90359936e+00,   1.76556549e+01],
        [  5.66418177e+00,   4.91604748e+00,   1.39940933e+01]],

       [[  4.07745958e+00,   1.90359936e+00,   1.76556549e+01],
        [  7.49480615e+00,   2.79965551e-01,   1.43870380e+01]],

       [[ -7.48323440e+00,   5.01399730e-01,   1.26657592e+01],
        [ -4.03122313e+00,   3.08877357e+00,   1.51933503e+01]],

       [[ -7.48323440e+00,   5.01399730e-01,   1.26657592e+01],
        [ -6.21437664e+00,  -4.19905014e+00,   1.15277565e+01]],

       [[ -7.48323440e+00,   5.01399730e-01,   1.26657592e+01],
        [ -5.75241046e+00,   4.81247915e+00,   1.08168649e+01]],

       [[ -4.09613957e+00,   1.86317779e+00,   7.13471278e+00],
        [ -7.21622241e+00,  -2.04366669e+00,   7.12896366e+00]],

       [[ -4.09613957e+00,   1.86317779e+00,   7.13471278e+00],
        [ -3.32533837e+00,   6.72253337e+00,   6.24531575e+00]],

       [[ -4.09613957e+00,   1.86317779e+00,   7.13471278e+00],
        [ -5.75241046e+00,   4.81247915e+00,   1.08168649e+01]],

       [[  6.68112905e+00,  -3.40771144e+00,   1.11103743e+01],
        [  5.20798129e+00,  -5.39705443e+00,   6.76652214e+00]],

       [[  6.68112905e+00,  -3.40771144e+00,   1.11103743e+01],
        [  3.55332985e+00,  -2.76105881e+00,   1.49571215e+01]],

       [[  6.68112905e+00,  -3.40771144e+00,   1.11103743e+01],
        [  7.49480615e+00,   2.79965551e-01,   1.43870380e+01]],

       [[ -4.42915855e+00,   6.05248336e+00,   4.72501962e+01],
        [ -6.24538973e+00,   4.15272891e+00,   4.29967089e+01]],

       [[ -4.42915855e+00,   6.05248336e+00,   4.72501962e+01],
        [ -1.30976411e+00,   7.38475319e+00,   4.35767320e+01]],

       [[ -6.47631121e+00,  -3.78250262e+00,   2.49994207e+00],
        [ -7.21622241e+00,  -2.04366669e+00,   7.12896366e+00]],

       [[ -6.47631121e+00,  -3.78250262e+00,   2.49994207e+00],
        [ -7.41467061e+00,   1.12848151e+00,   2.49999992e+00]],

       [[ -6.47631121e+00,  -3.78250262e+00,   2.49994207e+00],
        [ -2.65992833e+00,  -7.01251428e+00,   2.49990320e+00]],

       [[ -3.77717677e+00,   6.47943051e+00,   3.93232516e+01],
        [  7.54354997e-01,   4.49717972e+00,   4.00551870e+01]],

       [[ -3.77717677e+00,   6.47943051e+00,   3.93232516e+01],
        [ -6.24538973e+00,   4.15272891e+00,   4.29967089e+01]],

       [[ -3.77717677e+00,   6.47943051e+00,   3.93232516e+01],
        [ -1.30976411e+00,   7.38475319e+00,   4.35767320e+01]],

       [[ -3.77717677e+00,   6.47943051e+00,   3.93232516e+01],
        [ -6.83208553e+00,   3.09396025e+00,   3.72724861e+01]],

       [[ -3.77717677e+00,   6.47943051e+00,   3.93232516e+01],
        [ -5.83782406e-02,   7.49977925e+00,   3.61406297e+01]],

       [[  6.16700968e+00,  -4.26825846e+00,   4.21930781e+01],
        [  5.49232762e+00,  -5.10728286e+00,   4.70757768e+01]],

       [[  6.16700968e+00,  -4.26825846e+00,   4.21930781e+01],
        [  6.95409079e+00,  -2.80907919e+00,   3.74759763e+01]],

       [[  6.16700968e+00,  -4.26825846e+00,   4.21930781e+01],
        [  1.92074519e+00,  -4.09225602e+00,   3.95590286e+01]],

       [[  6.16700968e+00,  -4.26825846e+00,   4.21930781e+01],
        [  7.48045093e+00,   5.41201916e-01,   4.25723314e+01]],

       [[  6.16700968e+00,  -4.26825846e+00,   4.21930781e+01],
        [  2.35570729e+00,  -7.12044032e+00,   4.37224286e+01]],

       [[ -1.70214942e+00,  -7.30429723e+00,   4.08069711e+01],
        [ -5.90664351e+00,  -4.62185942e+00,   4.11629830e+01]],

       [[ -1.70214942e+00,  -7.30429723e+00,   4.08069711e+01],
        [ -3.77181515e+00,  -6.48254656e+00,   4.52837060e+01]],

       [[ -1.70214942e+00,  -7.30429723e+00,   4.08069711e+01],
        [ -2.62538699e+00,  -3.65475119e+00,   3.75163417e+01]],

       [[ -1.70214942e+00,  -7.30429723e+00,   4.08069711e+01],
        [  1.92074519e+00,  -4.09225602e+00,   3.95590286e+01]],

       [[ -1.70214942e+00,  -7.30429723e+00,   4.08069711e+01],
        [  2.35570729e+00,  -7.12044032e+00,   4.37224286e+01]],

       [[  6.10973926e+00,   4.34986297e+00,   3.03565333e+01],
        [  1.99589767e+00,   4.03312805e+00,   3.31805491e+01]],

       [[  6.10973926e+00,   4.34986297e+00,   3.03565333e+01],
        [  2.61219726e+00,   7.03040040e+00,   2.79940518e+01]],

       [[  6.10973926e+00,   4.34986297e+00,   3.03565333e+01],
        [  7.49897125e+00,   1.24236208e-01,   2.80733490e+01]],

       [[  6.10973926e+00,   4.34986297e+00,   3.03565333e+01],
        [  7.16105591e+00,   2.22919049e+00,   3.47607815e+01]],

       [[  2.00079235e+00,   4.03073164e+00,   4.52472334e+01],
        [  5.51576632e+00,   5.08196162e+00,   4.18502135e+01]],

       [[  2.00079235e+00,   4.03073164e+00,   4.52472334e+01],
        [  6.73583657e+00,   3.29826207e+00,   4.66764850e+01]],

       [[  2.00079235e+00,   4.03073164e+00,   4.52472334e+01],
        [ -1.30976411e+00,   7.38475319e+00,   4.35767320e+01]],

       [[ -2.14890329e+00,   7.18556645e+00,   1.73550383e+01],
        [  6.95123031e-01,   4.44596477e+00,   1.42881904e+01]],

       [[ -2.14890329e+00,   7.18556645e+00,   1.73550383e+01],
        [ -4.03122313e+00,   3.08877357e+00,   1.51933503e+01]],

       [[ -2.14890329e+00,   7.18556645e+00,   1.73550383e+01],
        [ -2.28758869e+00,   7.14266322e+00,   2.23528772e+01]],

       [[ -2.61722413e+00,  -3.66061646e+00,   2.32066588e+01],
        [  1.12663921e+00,  -4.35665975e+00,   2.64468556e+01]],

       [[ -2.61722413e+00,  -3.66061646e+00,   2.32066588e+01],
        [ -6.80936958e-01,  -4.44816897e+00,   1.86646269e+01]],

       [[ -2.61722413e+00,  -3.66061646e+00,   2.32066588e+01],
        [ -6.58346296e+00,  -3.59283770e+00,   2.62503266e+01]],

       [[ -7.46306246e+00,   7.44316653e-01,   1.79728776e+01],
        [ -4.07643482e+00,  -1.90576901e+00,   1.54224416e+01]],

       [[ -7.46306246e+00,   7.44316653e-01,   1.79728776e+01],
        [ -7.49996450e+00,   2.22514242e-02,   2.29201791e+01]],

       [[ -7.46306246e+00,   7.44316653e-01,   1.79728776e+01],
        [ -4.03122313e+00,   3.08877357e+00,   1.51933503e+01]],

       [[ -7.46306246e+00,   7.44316653e-01,   1.79728776e+01],
        [ -3.60089458e+00,   2.69875275e+00,   2.04752956e+01]],

       [[ -1.15224380e+00,   7.41098449e+00,   3.12625881e+01],
        [  1.99589767e+00,   4.03312805e+00,   3.31805491e+01]],

       [[ -1.15224380e+00,   7.41098449e+00,   3.12625881e+01],
        [ -3.06631509e+00,   3.29358351e+00,   3.33562014e+01]],

       [[ -1.15224380e+00,   7.41098449e+00,   3.12625881e+01],
        [  2.61219726e+00,   7.03040040e+00,   2.79940518e+01]],

       [[ -1.15224380e+00,   7.41098449e+00,   3.12625881e+01],
        [ -5.27975869e+00,   5.32675207e+00,   2.93603432e+01]],

       [[ -1.15224380e+00,   7.41098449e+00,   3.12625881e+01],
        [ -5.83782406e-02,   7.49977925e+00,   3.61406297e+01]],

       [[  6.95123031e-01,   4.44596477e+00,   1.42881904e+01],
        [ -4.03122313e+00,   3.08877357e+00,   1.51933503e+01]],

       [[  6.95123031e-01,   4.44596477e+00,   1.42881904e+01],
        [ -1.44935603e+00,   7.35863402e+00,   1.08361185e+01]],

       [[  6.95123031e-01,   4.44596477e+00,   1.42881904e+01],
        [  3.14760651e+00,   6.80754125e+00,   1.79499152e+01]],

       [[  6.95123031e-01,   4.44596477e+00,   1.42881904e+01],
        [  5.66418177e+00,   4.91604748e+00,   1.39940933e+01]],

       [[ -3.04577107e+00,  -6.85376133e+00,   2.76101613e+01],
        [  1.12663921e+00,  -4.35665975e+00,   2.64468556e+01]],

       [[ -3.04577107e+00,  -6.85376133e+00,   2.76101613e+01],
        [ -6.58346296e+00,  -3.59283770e+00,   2.62503266e+01]],

       [[ -3.04577107e+00,  -6.85376133e+00,   2.76101613e+01],
        [ -7.87663445e-01,  -5.29760758e+00,   3.17908845e+01]],

       [[  1.99589767e+00,   4.03312805e+00,   3.31805491e+01],
        [  4.60570450e+00,   5.91926625e+00,   3.70055815e+01]],

       [[  1.99589767e+00,   4.03312805e+00,   3.31805491e+01],
        [ -5.83782406e-02,   7.49977925e+00,   3.61406297e+01]],

       [[ -3.06631509e+00,   3.29358351e+00,   3.33562014e+01],
        [ -5.27975869e+00,   5.32675207e+00,   2.93603432e+01]],

       [[ -3.06631509e+00,   3.29358351e+00,   3.33562014e+01],
        [ -7.44125067e+00,   9.36923600e-01,   3.28030498e+01]],

       [[ -7.21622241e+00,  -2.04366669e+00,   7.12896366e+00],
        [ -6.21437664e+00,  -4.19905014e+00,   1.15277565e+01]],

       [[ -3.32533837e+00,   6.72253337e+00,   6.24531575e+00],
        [ -1.05593578e-01,   7.49935032e+00,   2.49983516e+00]],

       [[ -3.32533837e+00,   6.72253337e+00,   6.24531575e+00],
        [ -1.44935603e+00,   7.35863402e+00,   1.08361185e+01]],

       [[  5.20798129e+00,  -5.39705443e+00,   6.76652214e+00],
        [  6.95394648e-01,  -7.46773765e+00,   6.17847536e+00]],

       [[  5.20798129e+00,  -5.39705443e+00,   6.76652214e+00],
        [  6.74020138e+00,  -3.28941605e+00,   2.49971430e+00]],

       [[  5.20798129e+00,  -5.39705443e+00,   6.76652214e+00],
        [  1.65135472e+00,  -4.18601138e+00,   1.00653772e+01]],

       [[ -4.07643482e+00,  -1.90576901e+00,   1.54224416e+01],
        [ -3.15685073e+00,  -6.80331185e+00,   1.50146308e+01]],

       [[ -4.07643482e+00,  -1.90576901e+00,   1.54224416e+01],
        [ -4.03122313e+00,   3.08877357e+00,   1.51933503e+01]],

       [[ -4.07643482e+00,  -1.90576901e+00,   1.54224416e+01],
        [ -6.21437664e+00,  -4.19905014e+00,   1.15277565e+01]],

       [[  2.61219726e+00,   7.03040040e+00,   2.79940518e+01],
        [  2.66907012e+00,   7.00903674e+00,   2.29945054e+01]],

       [[  2.61219726e+00,   7.03040040e+00,   2.79940518e+01],
        [  3.54506155e+00,   2.77173600e+00,   2.55458901e+01]],

       [[  6.12319738e+00,  -4.33092564e+00,   2.62682995e+01],
        [  1.12663921e+00,  -4.35665975e+00,   2.64468556e+01]],

       [[  6.12319738e+00,  -4.33092564e+00,   2.62682995e+01],
        [  4.06548373e+00,  -6.30252651e+00,   3.03766424e+01]],

       [[  6.12319738e+00,  -4.33092564e+00,   2.62682995e+01],
        [  7.46980753e+00,  -6.72601069e-01,   2.31374397e+01]],

       [[  6.12319738e+00,  -4.33092564e+00,   2.62682995e+01],
        [  7.49897125e+00,   1.24236208e-01,   2.80733490e+01]],

       [[ -7.49996450e+00,   2.22514242e-02,   2.29201791e+01],
        [ -5.98118951e+00,   4.52499257e+00,   2.44751700e+01]],

       [[ -7.49996450e+00,   2.22514242e-02,   2.29201791e+01],
        [ -7.42116773e+00,   1.08465970e+00,   2.78053355e+01]],

       [[ -7.49996450e+00,   2.22514242e-02,   2.29201791e+01],
        [ -6.58346296e+00,  -3.59283770e+00,   2.62503266e+01]],

       [[ -4.49781916e+00,   1.39929703e-01,   4.05794153e+01],
        [ -5.90664351e+00,  -4.62185942e+00,   4.11629830e+01]],

       [[ -4.49781916e+00,   1.39929703e-01,   4.05794153e+01],
        [ -6.24538973e+00,   4.15272891e+00,   4.29967089e+01]],

       [[ -4.49781916e+00,   1.39929703e-01,   4.05794153e+01],
        [ -7.26162170e+00,  -1.87593200e+00,   3.69328430e+01]],

       [[ -5.42234971e+00,  -5.18152727e+00,   3.36632980e+01],
        [ -2.62538699e+00,  -3.65475119e+00,   3.75163417e+01]],

       [[ -5.42234971e+00,  -5.18152727e+00,   3.36632980e+01],
        [ -4.12472447e+00,  -1.79905702e+00,   3.02172962e+01]],

       [[ -5.42234971e+00,  -5.18152727e+00,   3.36632980e+01],
        [ -7.26162170e+00,  -1.87593200e+00,   3.69328430e+01]],

       [[ -5.42234971e+00,  -5.18152727e+00,   3.36632980e+01],
        [ -7.87663445e-01,  -5.29760758e+00,   3.17908845e+01]],

       [[ -3.15685073e+00,  -6.80331185e+00,   1.50146308e+01],
        [ -6.80936958e-01,  -4.44816897e+00,   1.86646269e+01]],

       [[ -3.15685073e+00,  -6.80331185e+00,   1.50146308e+01],
        [  1.70805257e+00,  -7.30294452e+00,   1.39743943e+01]],

       [[ -3.15685073e+00,  -6.80331185e+00,   1.50146308e+01],
        [ -2.41000470e+00,  -7.10226878e+00,   1.00798776e+01]],

       [[  7.44548510e+00,  -9.02638628e-01,   6.83628712e+00],
        [  6.74020138e+00,  -3.28941605e+00,   2.49971430e+00]],

       [[  7.44548510e+00,  -9.02638628e-01,   6.83628712e+00],
        [  6.35828164e+00,   3.97772512e+00,   6.83640732e+00]],

       [[  3.23999557e+00,  -3.12286029e+00,   2.20867142e+01],
        [  1.12663921e+00,  -4.35665975e+00,   2.64468556e+01]],

       [[  3.23999557e+00,  -3.12286029e+00,   2.20867142e+01],
        [  3.91371421e+00,  -6.39791744e+00,   1.83693090e+01]],

       [[  3.23999557e+00,  -3.12286029e+00,   2.20867142e+01],
        [  7.46980753e+00,  -6.72601069e-01,   2.31374397e+01]],

       [[  3.23999557e+00,  -3.12286029e+00,   2.20867142e+01],
        [  7.70395302e-01,  -7.46033072e+00,   2.23822153e+01]],

       [[ -7.41467061e+00,   1.12848151e+00,   2.49999992e+00],
        [ -2.95676340e+00,   3.39224178e+00,   2.50299113e+00]],

       [[  6.95394648e-01,  -7.46773765e+00,   6.17847536e+00],
        [ -2.65992833e+00,  -7.01251428e+00,   2.49990320e+00]],

       [[  6.95394648e-01,  -7.46773765e+00,   6.17847536e+00],
        [ -2.41000470e+00,  -7.10226878e+00,   1.00798776e+01]],

       [[ -5.90664351e+00,  -4.62185942e+00,   4.11629830e+01],
        [ -2.62538699e+00,  -3.65475119e+00,   3.75163417e+01]],

       [[ -5.98118951e+00,   4.52499257e+00,   2.44751700e+01],
        [ -5.27975869e+00,   5.32675207e+00,   2.93603432e+01]],

       [[ -5.98118951e+00,   4.52499257e+00,   2.44751700e+01],
        [ -7.42116773e+00,   1.08465970e+00,   2.78053355e+01]],

       [[ -5.98118951e+00,   4.52499257e+00,   2.44751700e+01],
        [ -2.28758869e+00,   7.14266322e+00,   2.23528772e+01]],

       [[ -5.98118951e+00,   4.52499257e+00,   2.44751700e+01],
        [ -1.35298224e+00,   4.29178635e+00,   2.63527481e+01]],

       [[ -5.98118951e+00,   4.52499257e+00,   2.44751700e+01],
        [ -3.60089458e+00,   2.69875275e+00,   2.04752956e+01]],

       [[  5.51576632e+00,   5.08196162e+00,   4.18502135e+01],
        [  4.60570450e+00,   5.91926625e+00,   3.70055815e+01]],

       [[  5.51576632e+00,   5.08196162e+00,   4.18502135e+01],
        [  7.48045093e+00,   5.41201916e-01,   4.25723314e+01]],

       [[  6.73583657e+00,   3.29826207e+00,   4.66764850e+01],
        [  7.48045093e+00,   5.41201916e-01,   4.25723314e+01]],

       [[  4.63123874e+00,   5.89935993e+00,   2.49999098e+00],
        [ -1.05593578e-01,   7.49935032e+00,   2.49983516e+00]],

       [[  4.63123874e+00,   5.89935993e+00,   2.49999098e+00],
        [  7.30998594e+00,   1.67776312e+00,   2.49999855e+00]],

       [[  2.85840832e+00,  -3.47553831e+00,   3.46866242e+01],
        [  6.95409079e+00,  -2.80907919e+00,   3.74759763e+01]],

       [[  2.85840832e+00,  -3.47553831e+00,   3.46866242e+01],
        [  1.92074519e+00,  -4.09225602e+00,   3.95590286e+01]],

       [[  2.85840832e+00,  -3.47553831e+00,   3.46866242e+01],
        [  2.72642170e-01,  -7.49506489e+00,   3.61551686e+01]],

       [[  2.85840832e+00,  -3.47553831e+00,   3.46866242e+01],
        [  7.16422740e+00,  -2.21901018e+00,   3.24774932e+01]],

       [[  2.85840832e+00,  -3.47553831e+00,   3.46866242e+01],
        [ -7.87663445e-01,  -5.29760758e+00,   3.17908845e+01]],

       [[ -5.27975869e+00,   5.32675207e+00,   2.93603432e+01],
        [ -7.42116773e+00,   1.08465970e+00,   2.78053355e+01]],

       [[ -6.80936958e-01,  -4.44816897e+00,   1.86646269e+01],
        [  3.91371421e+00,  -6.39791744e+00,   1.83693090e+01]],

       [[ -6.80936958e-01,  -4.44816897e+00,   1.86646269e+01],
        [  7.70395302e-01,  -7.46033072e+00,   2.23822153e+01]],

       [[  4.38784877e+00,   9.98389165e-01,   1.03351129e+01],
        [  6.35828164e+00,   3.97772512e+00,   6.83640732e+00]],

       [[ -7.42116773e+00,   1.08465970e+00,   2.78053355e+01],
        [ -7.44125067e+00,   9.36923600e-01,   3.28030498e+01]],

       [[ -7.42116773e+00,   1.08465970e+00,   2.78053355e+01],
        [ -4.12472447e+00,  -1.79905702e+00,   3.02172962e+01]],

       [[ -7.42116773e+00,   1.08465970e+00,   2.78053355e+01],
        [ -6.58346296e+00,  -3.59283770e+00,   2.62503266e+01]],

       [[ -2.28758869e+00,   7.14266322e+00,   2.23528772e+01],
        [  2.66907012e+00,   7.00903674e+00,   2.29945054e+01]],

       [[ -2.28758869e+00,   7.14266322e+00,   2.23528772e+01],
        [ -1.35298224e+00,   4.29178635e+00,   2.63527481e+01]],

       [[ -2.28758869e+00,   7.14266322e+00,   2.23528772e+01],
        [ -3.60089458e+00,   2.69875275e+00,   2.04752956e+01]],

       [[  1.43977789e+00,   4.26341662e+00,   5.98400924e+00],
        [ -1.05593578e-01,   7.49935032e+00,   2.49983516e+00]],

       [[  1.43977789e+00,   4.26341662e+00,   5.98400924e+00],
        [  3.41330213e+00,   6.67830660e+00,   9.89202078e+00]],

       [[  1.43977789e+00,   4.26341662e+00,   5.98400924e+00],
        [  6.35828164e+00,   3.97772512e+00,   6.83640732e+00]],

       [[ -7.44125067e+00,   9.36923600e-01,   3.28030498e+01],
        [ -6.83208553e+00,   3.09396025e+00,   3.72724861e+01]],

       [[ -7.44125067e+00,   9.36923600e-01,   3.28030498e+01],
        [ -7.26162170e+00,  -1.87593200e+00,   3.69328430e+01]],

       [[  6.74020138e+00,  -3.28941605e+00,   2.49971430e+00],
        [  7.30998594e+00,   1.67776312e+00,   2.49999855e+00]],

       [[  3.91371421e+00,  -6.39791744e+00,   1.83693090e+01],
        [  1.70805257e+00,  -7.30294452e+00,   1.39743943e+01]],

       [[  3.91371421e+00,  -6.39791744e+00,   1.83693090e+01],
        [  7.06462608e+00,  -2.51819061e+00,   1.85083227e+01]],

       [[  3.91371421e+00,  -6.39791744e+00,   1.83693090e+01],
        [  3.55332985e+00,  -2.76105881e+00,   1.49571215e+01]],

       [[ -1.05593578e-01,   7.49935032e+00,   2.49983516e+00],
        [ -2.95676340e+00,   3.39224178e+00,   2.50299113e+00]],

       [[ -6.21437664e+00,  -4.19905014e+00,   1.15277565e+01],
        [ -2.41000470e+00,  -7.10226878e+00,   1.00798776e+01]],

       [[  7.46980753e+00,  -6.72601069e-01,   2.31374397e+01],
        [  6.37239450e+00,   3.95516590e+00,   2.15955017e+01]],

       [[  7.46980753e+00,  -6.72601069e-01,   2.31374397e+01],
        [  7.49897125e+00,   1.24236208e-01,   2.80733490e+01]],

       [[  7.46980753e+00,  -6.72601069e-01,   2.31374397e+01],
        [  7.06462608e+00,  -2.51819061e+00,   1.85083227e+01]],

       [[  7.54354997e-01,   4.49717972e+00,   4.00551870e+01],
        [ -1.30976411e+00,   7.38475319e+00,   4.35767320e+01]],

       [[  7.54354997e-01,   4.49717972e+00,   4.00551870e+01],
        [ -5.83782406e-02,   7.49977925e+00,   3.61406297e+01]],

       [[  6.37239450e+00,   3.95516590e+00,   2.15955017e+01],
        [  2.66907012e+00,   7.00903674e+00,   2.29945054e+01]],

       [[  6.37239450e+00,   3.95516590e+00,   2.15955017e+01],
        [  3.54506155e+00,   2.77173600e+00,   2.55458901e+01]],

       [[ -2.62538699e+00,  -3.65475119e+00,   3.75163417e+01],
        [  2.72642170e-01,  -7.49506489e+00,   3.61551686e+01]],

       [[ -2.62538699e+00,  -3.65475119e+00,   3.75163417e+01],
        [ -7.26162170e+00,  -1.87593200e+00,   3.69328430e+01]],

       [[  7.49897125e+00,   1.24236208e-01,   2.80733490e+01],
        [  7.16422740e+00,  -2.21901018e+00,   3.24774932e+01]],

       [[ -4.12472447e+00,  -1.79905702e+00,   3.02172962e+01],
        [ -6.58346296e+00,  -3.59283770e+00,   2.62503266e+01]],

       [[  1.70805257e+00,  -7.30294452e+00,   1.39743943e+01],
        [  1.65135472e+00,  -4.18601138e+00,   1.00653772e+01]],

       [[  1.70805257e+00,  -7.30294452e+00,   1.39743943e+01],
        [  3.55332985e+00,  -2.76105881e+00,   1.49571215e+01]],

       [[  3.41330213e+00,   6.67830660e+00,   9.89202078e+00],
        [ -1.44935603e+00,   7.35863402e+00,   1.08361185e+01]],

       [[  3.41330213e+00,   6.67830660e+00,   9.89202078e+00],
        [  5.66418177e+00,   4.91604748e+00,   1.39940933e+01]],

       [[  7.06462608e+00,  -2.51819061e+00,   1.85083227e+01],
        [  3.55332985e+00,  -2.76105881e+00,   1.49571215e+01]],

       [[  7.06462608e+00,  -2.51819061e+00,   1.85083227e+01],
        [  7.49480615e+00,   2.79965551e-01,   1.43870380e+01]],

       [[ -1.44935603e+00,   7.35863402e+00,   1.08361185e+01],
        [ -5.75241046e+00,   4.81247915e+00,   1.08168649e+01]],

       [[  7.16105591e+00,   2.22919049e+00,   3.47607815e+01],
        [  7.16422740e+00,  -2.21901018e+00,   3.24774932e+01]],

       [[  4.60570450e+00,   5.91926625e+00,   3.70055815e+01],
        [ -5.83782406e-02,   7.49977925e+00,   3.61406297e+01]],

       [[ -6.83208553e+00,   3.09396025e+00,   3.72724861e+01],
        [ -7.26162170e+00,  -1.87593200e+00,   3.69328430e+01]],

       [[ -2.41000470e+00,  -7.10226878e+00,   1.00798776e+01],
        [  1.65135472e+00,  -4.18601138e+00,   1.00653772e+01]],

       [[  5.66418177e+00,   4.91604748e+00,   1.39940933e+01],
        [  7.49480615e+00,   2.79965551e-01,   1.43870380e+01]]])
        
 
coord_of_cylinders_walls = np.array([[[ 11.8620403 ,  12.17752041,   8.2868275 ],
        [ 14.16467164,  14.541392  ,   8.2868275 ]],

       [[  8.62117414, -14.65180552,  14.32550003],
        [ 10.29469604, -17.49597929,  14.32550003]],

       [[  6.16408739, -15.84311768,   8.96791969],
        [  7.3606448 , -18.91854454,   8.96791969]],

       [[ -7.54889698,  15.23203519,   2.99998302],
        [ -9.01426922,  18.18883823,   2.99998302]],

       [[  4.21230051,  16.46987254,   2.99999897],
        [  5.02998212,  19.66696447,   2.99999897]],

       [[  0.89518832, -16.97641445,   3.        ],
        [  1.06896016, -20.27183602,   3.        ]],

       [[ 16.23026496,  -5.05752891,   8.59333012],
        [ 19.38084526,  -6.03928436,   8.59333012]],

       [[ 11.27688098, -12.72135431,   9.3035465 ],
        [ 13.46591917, -15.19078983,   9.3035465 ]],

       [[-16.31802697,   4.76680302,  10.06725706],
        [-19.48564169,   5.69212294,  10.06725706]],

       [[-16.94697504,   1.3425533 ,   2.99997705],
        [-20.23666823,   1.6031655 ,   2.99997705]],

       [[  6.73706472, -15.60807988,   2.99998973],
        [  8.04484742, -18.63788258,   2.99998973]],

       [[-16.95709662,  -1.20708254,   9.22750983],
        [-20.24876732,  -1.44139849,   9.22750983]],

       [[ 16.98672304,   0.67204506,  10.20559811],
        [ 20.28414344,   0.80250078,  10.20559811]],

       [[-12.31035328, -11.72412973,   7.62725827],
        [-14.70001003, -13.99999015,   7.62725827]],

       [[ 16.50943786,  -4.05443831,  15.50046372],
        [ 19.71421104,  -4.84147632,  15.50046372]],

       [[-12.47699595,  11.5466284 ,  13.26647895],
        [-14.89900081,  13.78803252,  13.26647895]],

       [[ -9.95740314,  13.77861176,   8.29962558],
        [-11.89031074,  16.45328336,   8.29962558]],

       [[ -3.54963885,  16.62528388,  17.93096005],
        [ -4.2386864 ,  19.85254487,  17.93096005]],

       [[-14.09149315,  -9.50945966,  19.26727187],
        [-16.82690063, -11.35541359,  19.26727187]],

       [[ 15.27997932,  -7.45133547,   3.        ],
        [ 18.24609209,  -8.89777076,   3.        ]],

       [[  6.82755214,  15.56870414,   8.32431602],
        [  8.15290046,  18.59086427,   8.32431602]]])


coord_of_cylinders_cavity = np.array([[[  3.61456488,  -7.13686467,  15.6786228 ],
        [  2.1235559 ,  -4.19290607,  15.6786228 ]],

       [[ -7.7415133 ,  -2.01708643,   2.99997758],
        [ -4.54813073,  -1.18503611,   2.99997758]],

       [[ -6.41463757,   4.78042051,  18.55069553],
        [ -3.76859948,   2.80849698,  18.55069553]],

       [[  7.70339383,   2.15791895,   2.99998372],
        [  4.52571634,   1.26776967,   2.99998372]],

       [[ -4.1299476 ,  -6.85150065,   6.77609971],
        [ -2.42633794,  -4.02524622,   6.77609971]],

       [[ -7.98369105,   0.51055299,  14.63838405],
        [ -4.69041816,   0.29994986,  14.63838405]],

       [[  5.70751108,  -5.60573823,   3.        ],
        [  3.35316246,  -3.29337092,   3.        ]],

       [[ -7.53696626,  -2.68218524,  19.69870163],
        [ -4.42796714,  -1.57578364,  19.69870163]],

       [[ -5.76500836,   5.54653762,   2.99999996],
        [ -3.38693128,   3.25858014,   2.99999996]],

       [[ -6.52362641,   4.63057657,   8.88094327],
        [ -3.83262927,   2.72046285,   8.88094327]]])     




coord_of_cylinders_bottom = np.array([[[ 11.73970559, -12.29549696,   3.        ],
        [ 11.73970559, -12.29549696,  -0.3       ]],

       [[ -1.77173227,  16.90742293,   2.99999842],
        [ -1.77173227,  16.90742293,  -0.30000158]],

       [[ -7.7415133 ,  -2.01708643,   2.99997758],
        [ -7.7415133 ,  -2.01708643,  -0.30002242]],

       [[ -7.54889698,  15.23203519,   2.99998302],
        [ -7.54889698,  15.23203519,  -0.30001698]],

       [[  4.21230051,  16.46987254,   2.99999897],
        [  4.21230051,  16.46987254,  -0.30000103]],

       [[  7.70339383,   2.15791895,   2.99998372],
        [  7.70339383,   2.15791895,  -0.30001628]],

       [[ -3.01908027, -11.3799347 ,   2.99998956],
        [ -3.01908027, -11.3799347 ,  -0.30001044]],

       [[ 16.44654381,   4.30239018,   2.99999997],
        [ 16.44654381,   4.30239018,  -0.30000003]],

       [[-14.61706738,  -8.67993573,   2.99997352],
        [-14.61706738,  -8.67993573,  -0.30002648]],

       [[-10.02830201,   9.7683386 ,   2.99999327],
        [-10.02830201,   9.7683386 ,  -0.30000673]],

       [[  9.67161398,  13.98069671,   2.99999891],
        [  9.67161398,  13.98069671,  -0.30000109]],

       [[-16.94697504,   1.3425533 ,   2.99997705],
        [-16.94697504,   1.3425533 ,  -0.30002295]],

       [[  6.73706472, -15.60807988,   2.99998973],
        [  6.73706472, -15.60807988,  -0.30001027]],

       [[ -3.28616088,  11.01018088,   2.99999997],
        [ -3.28616088,  11.01018088,  -0.30000003]],

       [[  8.14722072,   8.1412065 ,   2.99999997],
        [  8.14722072,   8.1412065 ,  -0.30000003]],

       [[ 16.91678222,  -1.6789694 ,   2.99999998],
        [ 16.91678222,  -1.6789694 ,  -0.30000002]],

       [[  2.9649046 , -10.94219321,   3.        ],
        [  2.9649046 , -10.94219321,  -0.3       ]],

       [[ -8.66223576,  -7.94598955,   2.99997378],
        [ -8.66223576,  -7.94598955,  -0.30002622]],

       [[ -5.76500836,   5.54653762,   2.99999996],
        [ -5.76500836,   5.54653762,  -0.30000004]],

       [[ 13.92755096,   9.74779375,   2.99999562],
        [ 13.92755096,   9.74779375,  -0.30000438]],

       [[  2.70333359,  10.66289136,   2.99999843],
        [  2.70333359,  10.66289136,  -0.30000157]],

       [[-15.4249899 ,   7.14628414,   3.        ],
        [-15.4249899 ,   7.14628414,  -0.3       ]],

       [[-11.15716839,   2.91575186,   2.99999045],
        [-11.15716839,   2.91575186,  -0.30000955]],

       [[ 11.02958207,  -2.83541693,   2.99992164],
        [ 11.02958207,  -2.83541693,  -0.30007836]],

       [[ 15.27997932,  -7.45133547,   3.        ],
        [ 15.27997932,  -7.45133547,  -0.3       ]],

       [[ -8.89344566, -13.94150993,   2.99999657],
        [ -8.89344566, -13.94150993,  -0.30000343]]])

        
for u in range(len(coord_of_cylinders)):
#	for p in range(len(coord_of_cylinders[u]["x"])):
	p1 = geompy.MakeVertex(coord_of_cylinders[u][0][0], coord_of_cylinders[u][0][1], coord_of_cylinders[u][0][2])	
	p2 = geompy.MakeVertex(coord_of_cylinders[u][1][0], coord_of_cylinders[u][1][1], coord_of_cylinders[u][1][2])	
	u = geompy.MakeVector(p1, p2)	
	c = geompy.MakeCylinder(p1, u, r_c, h_c)
	s1 = geompy.MakeSpherePntR(p1, radius)
	s2 = geompy.MakeSpherePntR(p2, radius)
	cu =  geompy.MakeCutList(c, [s1,s2])
	geompy.addToStudy(cu, "Cylinder_cutted" + str(u))


for u in range(len(coord_of_cylinders_walls)) :
	p1 = geompy.MakeVertex(coord_of_cylinders_walls[u][0][0], coord_of_cylinders_walls[u][0][1], coord_of_cylinders_walls[u][0][2])	
	p2 = geompy.MakeVertex(coord_of_cylinders_walls[u][1][0], coord_of_cylinders_walls[u][1][1], coord_of_cylinders_walls[u][1][2])	
	vv = geompy.MakeVector(p1, p2)	
	c = geompy.MakeCylinder(p1, vv, r_c, h_c)
	s1 = geompy.MakeSpherePntR(p1, radius)
	s1_common = geompy.MakeCommon(s1, cylinder)
	common_s_w = geompy.MakeCommon(c, cylinder)
	cut_cylinder = geompy.MakeCut(common_s_w, s1_common)
	geompy.addToStudy(cut_cylinder, "Sphere_wall_bridge" + str(u))

	
	
for u in range(len(coord_of_cylinders_cavity)) :
	p1 = geompy.MakeVertex(coord_of_cylinders_cavity[u][0][0], coord_of_cylinders_cavity[u][0][1], coord_of_cylinders_cavity[u][0][2])	
	p2 = geompy.MakeVertex(coord_of_cylinders_cavity[u][1][0], coord_of_cylinders_cavity[u][1][1], coord_of_cylinders_cavity[u][1][2])	
	vv = geompy.MakeVector(p1, p2)	
	c = geompy.MakeCylinder(p1, vv, r_c, h_c)
	s1 = geompy.MakeSpherePntR(p1, radius)
#	s1_common = geompy.MakeCommon(s1, cylinder_small)
#	common_s_w = geompy.MakeCommon(c, cylinder_small)
	cu =  geompy.MakeCutList(c, [s1, cylinder_small])
#	cut_cylinder = geompy.MakeCut(common_s_w, s1_common)
	geompy.addToStudy(cu, "Sphere_cavity_bridge" + str(u))	



for u in range(len(coord_of_cylinders_bottom)) :
	p1 = geompy.MakeVertex(coord_of_cylinders_bottom[u][0][0], coord_of_cylinders_bottom[u][0][1], coord_of_cylinders_bottom[u][0][2])	
	p2 = geompy.MakeVertex(coord_of_cylinders_bottom[u][1][0], coord_of_cylinders_bottom[u][1][1], coord_of_cylinders_bottom[u][1][2])	
	vv = geompy.MakeVector(p1, p2)	
	c = geompy.MakeCylinder(p1, vv, r_c, h_c)
	s1 = geompy.MakeSpherePntR(p1, radius)
	s1_common = geompy.MakeCommon(s1, cylinder)
	common_s_w = geompy.MakeCommon(c, cylinder)
	cut_cylinder = geompy.MakeCut(common_s_w, s1_common)
	geompy.addToStudy(cut_cylinder, "Sphere_bottom_bridge" + str(u))
