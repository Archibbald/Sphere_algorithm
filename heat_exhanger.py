#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
#  heat_exhanger.py
#  
#  Copyright 2020 Kristian Farkas <farkas@farkas>
#  
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.
#  
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#  
#  You should have received a copy of the GNU General Public License
#  along with this program; if not, write to the Free Software
#  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
#  MA 02110-1301, USA.
#  
#  

import numpy as np
import salome
salome.salome_init()
import GEOM
from salome.geom import geomBuilder
geompy = geomBuilder.New(salome.myStudy)
gg = salome.ImportComponentGUI("GEOM")

radius = 2.97
r_c = 0.3
h_c = 6
radius_c = 20
height = 500
radius_c_s = 5


cylinder = geompy.MakeCylinderRH(radius_c, height)
cylinder_small = geompy.MakeCylinderRH(radius_c_s, height)


arr = np.array([[  1.67125622,  -7.8234882 ,   7.95986178],
       [ -4.3057871 , -16.44566979,   5.94658009],
       [ 11.8620403 ,  12.17752041,   8.2868275 ],
       [ 11.73970559, -12.29549696,   3.        ],
       [ 10.78044553,  -7.13176491,   7.18037295],
       [  8.62117414, -14.65180552,  14.32550003],
       [  3.61456488,  -7.13686467,  15.6786228 ],
       [ 15.35372183,   7.29816363,   8.28821361],
       [ -1.77173227,  16.90742293,   2.99999842],
       [-11.4884543 ,   7.98218325,   8.53871411],
       [  7.06450122,   3.75627157,   9.44244554],
       [ -7.7415133 ,  -2.01708643,   2.99997758],
       [  8.180618  ,   7.75464951,  13.80708608],
       [  6.16408739, -15.84311768,   8.96791969],
       [ 12.86807637,   4.12911162,  12.86740437],
       [ -7.54889698,  15.23203519,   2.99998302],
       [  4.21230051,  16.46987254,   2.99999897],
       [ 12.29325531,   2.33894851,   6.86007244],
       [  0.89518832, -16.97641445,   3.        ],
       [ -3.78947373,   7.14300723,  13.59391026],
       [ -6.41463757,   4.78042051,  18.55069553],
       [ 11.91031192,  -1.77888397,  12.26062304],
       [ 16.23026496,  -5.05752891,   8.59333012],
       [  9.63536073,  -6.41385064,  15.31703692],
       [  7.70339383,   2.15791895,   2.99998372],
       [ 11.27688098, -12.72135431,   9.3035465 ],
       [ -3.01908027, -11.3799347 ,   2.99998956],
       [ -4.1299476 ,  -6.85150065,   6.77609971],
       [-16.95341113,  -1.25770536,  19.53144718],
       [ 16.44654381,   4.30239018,   2.99999997],
       [-14.61706738,  -8.67993573,   2.99997352],
       [-10.02830201,   9.7683386 ,   2.99999327],
       [  5.02269578, -12.2507544 ,  18.48310629],
       [-13.30365665,  -6.26844524,   9.91829197],
       [ -4.49078755,  16.39612108,   8.32402814],
       [-16.03183261,   5.65511651,  15.99421782],
       [ -3.12919191,  -7.36261898,  13.88249446],
       [ -7.98369105,   0.51055299,  14.63838405],
       [-16.31802697,   4.76680302,  10.06725706],
       [  9.67161398,  13.98069671,   2.99999891],
       [  6.65362643,  -9.27892064,  10.96955585],
       [  2.18499271,   7.69583061,  13.5859831 ],
       [-16.94697504,   1.3425533 ,   2.99997705],
       [  6.73706472, -15.60807988,   2.99998973],
       [ -3.28616088,  11.01018088,   2.99999997],
       [  5.70751108,  -5.60573823,   3.        ],
       [  8.14722072,   8.1412065 ,   2.99999997],
       [ 16.91678222,  -1.6789694 ,   2.99999998],
       [-16.95709662,  -1.20708254,   9.22750983],
       [  2.9649046 , -10.94219321,   3.        ],
       [ -7.53696626,  -2.68218524,  19.69870163],
       [ -8.66223576,  -7.94598955,   2.99997378],
       [ -5.76500836,   5.54653762,   2.99999996],
       [ -2.92529298, -11.95348622,   9.69453576],
       [ -7.36047008,  15.32394817,  13.48303517],
       [ 16.98672304,   0.67204506,  10.20559811],
       [  0.32468059, -16.9968931 ,   9.72209765],
       [-12.31035328, -11.72412973,   7.62725827],
       [ -3.70259102, -16.59188926,  14.15116005],
       [ -7.64243428,  -3.07028432,   9.83621195],
       [  6.16173294,   9.60753737,   8.46908047],
       [ 16.50943786,  -4.05443831,  15.50046372],
       [ -7.57242693,  10.45504375,  16.982859  ],
       [-11.55129759,   1.35760375,   8.78069284],
       [-13.96447423,   0.31574101,  14.19994656],
       [  7.82747297,   1.65247311,  15.00947987],
       [-12.47699595,  11.5466284 ,  13.26647895],
       [ -8.07185302, -14.96144604,  10.37584618],
       [-16.18672605,  -5.19515853,  15.06956201],
       [ 13.92755096,   9.74779375,   2.99999562],
       [ 14.43651983,  -8.97701706,  12.76713348],
       [ -8.02559453,  -8.97767107,  10.81382358],
       [-13.35408483,  -3.10425045,   4.82083444],
       [  2.70333359,  10.66289136,   2.99999843],
       [  1.57275094, -16.92707595,  16.98988258],
       [-13.5816345 ,  10.22444138,  19.01378346],
       [ -2.03700782, -11.95916951,  17.5809897 ],
       [ -9.95740314,  13.77861176,   8.29962558],
       [ -6.52362641,   4.63057657,   8.88094327],
       [ -1.05781983,  10.25182691,  17.93925947],
       [-15.4249899 ,   7.14628414,   3.        ],
       [-11.15716839,   2.91575186,   2.99999045],
       [ 11.02958207,  -2.83541693,   2.99992164],
       [ -3.54963885,  16.62528388,  17.93096005],
       [ -8.89258768, -14.48868115,  16.30523744],
       [ 13.72905649,  10.02561693,  13.56731481],
       [  7.74183567,  -2.01593629,   7.95160934],
       [ -4.99624093,  10.43072628,   8.72208749],
       [-14.09149315,  -9.50945966,  19.26727187],
       [  1.97407908, -12.34633822,  13.13564619],
       [-11.9547322 ,   2.62374511,  19.36076173],
       [ 15.27997932,  -7.45133547,   3.        ],
       [-10.17978744,  -5.17242588,  14.9222936 ],
       [ -8.89344566, -13.94150993,   2.99999657],
       [-12.94948488, -11.01411661,  13.57239039],
       [ -1.70028906,  13.31727169,  12.82142327],
       [  6.82755214,  15.56870414,   8.32431602],
       [  0.41630528,   7.98916117,   7.86010585],
       [-10.35078963,   5.99602419,  14.08495772],
       [  1.03774526,  14.19514744,   7.55525763]])


for u in range(len(arr)):
		u = geompy.MakeVertex(arr[u][0], arr[u][1], arr[u][2])
		sphere1 = geompy.MakeSpherePntR(u, radius)
		geompy.addToStudy(sphere1,"Sphere" + str(u))
	


coord_of_cylinders = np.array([[[  1.67125622,  -7.8234882 ,   7.95986178],
        [ -4.1299476 ,  -6.85150065,   6.77609971]],

       [[  1.67125622,  -7.8234882 ,   7.95986178],
        [  6.65362643,  -9.27892064,  10.96955585]],

       [[  1.67125622,  -7.8234882 ,   7.95986178],
        [  2.9649046 , -10.94219321,   3.        ]],

       [[ -4.3057871 , -16.44566979,   5.94658009],
        [ -3.01908027, -11.3799347 ,   2.99998956]],

       [[ -4.3057871 , -16.44566979,   5.94658009],
        [  0.32468059, -16.9968931 ,   9.72209765]],

       [[ -4.3057871 , -16.44566979,   5.94658009],
        [ -8.89344566, -13.94150993,   2.99999657]],

       [[ 11.8620403 ,  12.17752041,   8.2868275 ],
        [ 15.35372183,   7.29816363,   8.28821361]],

       [[ 11.8620403 ,  12.17752041,   8.2868275 ],
        [  9.67161398,  13.98069671,   2.99999891]],

       [[ 11.8620403 ,  12.17752041,   8.2868275 ],
        [ 13.72905649,  10.02561693,  13.56731481]],

       [[ 11.73970559, -12.29549696,   3.        ],
        [  6.73706472, -15.60807988,   2.99998973]],

       [[ 11.73970559, -12.29549696,   3.        ],
        [ 15.27997932,  -7.45133547,   3.        ]],

       [[ 10.78044553,  -7.13176491,   7.18037295],
        [ 16.23026496,  -5.05752891,   8.59333012]],

       [[ 10.78044553,  -7.13176491,   7.18037295],
        [ 11.27688098, -12.72135431,   9.3035465 ]],

       [[ 10.78044553,  -7.13176491,   7.18037295],
        [  6.65362643,  -9.27892064,  10.96955585]],

       [[ 10.78044553,  -7.13176491,   7.18037295],
        [ 11.02958207,  -2.83541693,   2.99992164]],

       [[ 10.78044553,  -7.13176491,   7.18037295],
        [  7.74183567,  -2.01593629,   7.95160934]],

       [[  8.62117414, -14.65180552,  14.32550003],
        [ 11.27688098, -12.72135431,   9.3035465 ]],

       [[  8.62117414, -14.65180552,  14.32550003],
        [  5.02269578, -12.2507544 ,  18.48310629]],

       [[  3.61456488,  -7.13686467,  15.6786228 ],
        [  5.02269578, -12.2507544 ,  18.48310629]],

       [[  3.61456488,  -7.13686467,  15.6786228 ],
        [  6.65362643,  -9.27892064,  10.96955585]],

       [[ 15.35372183,   7.29816363,   8.28821361],
        [ 12.29325531,   2.33894851,   6.86007244]],

       [[ 15.35372183,   7.29816363,   8.28821361],
        [ 13.92755096,   9.74779375,   2.99999562]],

       [[ -1.77173227,  16.90742293,   2.99999842],
        [  4.21230051,  16.46987254,   2.99999897]],

       [[ -1.77173227,  16.90742293,   2.99999842],
        [ -4.49078755,  16.39612108,   8.32402814]],

       [[ -1.77173227,  16.90742293,   2.99999842],
        [  1.03774526,  14.19514744,   7.55525763]],

       [[-11.4884543 ,   7.98218325,   8.53871411],
        [-10.02830201,   9.7683386 ,   2.99999327]],

       [[-11.4884543 ,   7.98218325,   8.53871411],
        [-16.31802697,   4.76680302,  10.06725706]],

       [[-11.4884543 ,   7.98218325,   8.53871411],
        [ -9.95740314,  13.77861176,   8.29962558]],

       [[-11.4884543 ,   7.98218325,   8.53871411],
        [ -6.52362641,   4.63057657,   8.88094327]],

       [[-11.4884543 ,   7.98218325,   8.53871411],
        [-10.35078963,   5.99602419,  14.08495772]],

       [[  7.06450122,   3.75627157,   9.44244554],
        [  6.16173294,   9.60753737,   8.46908047]],

       [[  7.06450122,   3.75627157,   9.44244554],
        [  7.82747297,   1.65247311,  15.00947987]],

       [[  7.06450122,   3.75627157,   9.44244554],
        [  7.74183567,  -2.01593629,   7.95160934]],

       [[ -7.7415133 ,  -2.01708643,   2.99997758],
        [ -8.66223576,  -7.94598955,   2.99997378]],

       [[ -7.7415133 ,  -2.01708643,   2.99997758],
        [-13.35408483,  -3.10425045,   4.82083444]],

       [[ -7.7415133 ,  -2.01708643,   2.99997758],
        [-11.15716839,   2.91575186,   2.99999045]],

       [[  8.180618  ,   7.75464951,  13.80708608],
        [ 12.86807637,   4.12911162,  12.86740437]],

       [[  8.180618  ,   7.75464951,  13.80708608],
        [  2.18499271,   7.69583061,  13.5859831 ]],

       [[  8.180618  ,   7.75464951,  13.80708608],
        [  6.16173294,   9.60753737,   8.46908047]],

       [[  8.180618  ,   7.75464951,  13.80708608],
        [ 13.72905649,  10.02561693,  13.56731481]],

       [[  6.16408739, -15.84311768,   8.96791969],
        [ 11.27688098, -12.72135431,   9.3035465 ]],

       [[  6.16408739, -15.84311768,   8.96791969],
        [  6.73706472, -15.60807988,   2.99998973]],

       [[  6.16408739, -15.84311768,   8.96791969],
        [  0.32468059, -16.9968931 ,   9.72209765]],

       [[ 12.86807637,   4.12911162,  12.86740437],
        [ 16.98672304,   0.67204506,  10.20559811]],

       [[ 12.86807637,   4.12911162,  12.86740437],
        [ 13.72905649,  10.02561693,  13.56731481]],

       [[ -7.54889698,  15.23203519,   2.99998302],
        [-10.02830201,   9.7683386 ,   2.99999327]],

       [[ -7.54889698,  15.23203519,   2.99998302],
        [ -3.28616088,  11.01018088,   2.99999997]],

       [[ -7.54889698,  15.23203519,   2.99998302],
        [ -9.95740314,  13.77861176,   8.29962558]],

       [[  4.21230051,  16.46987254,   2.99999897],
        [  9.67161398,  13.98069671,   2.99999891]],

       [[  4.21230051,  16.46987254,   2.99999897],
        [  2.70333359,  10.66289136,   2.99999843]],

       [[  4.21230051,  16.46987254,   2.99999897],
        [  6.82755214,  15.56870414,   8.32431602]],

       [[  4.21230051,  16.46987254,   2.99999897],
        [  1.03774526,  14.19514744,   7.55525763]],

       [[ 12.29325531,   2.33894851,   6.86007244],
        [  7.70339383,   2.15791895,   2.99998372]],

       [[ 12.29325531,   2.33894851,   6.86007244],
        [ 16.98672304,   0.67204506,  10.20559811]],

       [[  0.89518832, -16.97641445,   3.        ],
        [  6.73706472, -15.60807988,   2.99998973]],

       [[ -3.78947373,   7.14300723,  13.59391026],
        [  2.18499271,   7.69583061,  13.5859831 ]],

       [[ -3.78947373,   7.14300723,  13.59391026],
        [ -6.52362641,   4.63057657,   8.88094327]],

       [[ -3.78947373,   7.14300723,  13.59391026],
        [ -4.99624093,  10.43072628,   8.72208749]],

       [[ -6.41463757,   4.78042051,  18.55069553],
        [ -7.98369105,   0.51055299,  14.63838405]],

       [[ -6.41463757,   4.78042051,  18.55069553],
        [ -7.57242693,  10.45504375,  16.982859  ]],

       [[ -6.41463757,   4.78042051,  18.55069553],
        [-11.9547322 ,   2.62374511,  19.36076173]],

       [[ 11.91031192,  -1.77888397,  12.26062304],
        [  9.63536073,  -6.41385064,  15.31703692]],

       [[ 11.91031192,  -1.77888397,  12.26062304],
        [ 16.98672304,   0.67204506,  10.20559811]],

       [[ 11.91031192,  -1.77888397,  12.26062304],
        [  7.82747297,   1.65247311,  15.00947987]],

       [[ 11.91031192,  -1.77888397,  12.26062304],
        [  7.74183567,  -2.01593629,   7.95160934]],

       [[ 16.23026496,  -5.05752891,   8.59333012],
        [ 16.98672304,   0.67204506,  10.20559811]],

       [[ 16.23026496,  -5.05752891,   8.59333012],
        [ 14.43651983,  -8.97701706,  12.76713348]],

       [[  9.63536073,  -6.41385064,  15.31703692],
        [  6.65362643,  -9.27892064,  10.96955585]],

       [[  7.70339383,   2.15791895,   2.99998372],
        [  8.14722072,   8.1412065 ,   2.99999997]],

       [[  7.70339383,   2.15791895,   2.99998372],
        [ 11.02958207,  -2.83541693,   2.99992164]],

       [[ 11.27688098, -12.72135431,   9.3035465 ],
        [  6.65362643,  -9.27892064,  10.96955585]],

       [[ 11.27688098, -12.72135431,   9.3035465 ],
        [ 14.43651983,  -8.97701706,  12.76713348]],

       [[ -3.01908027, -11.3799347 ,   2.99998956],
        [ -4.1299476 ,  -6.85150065,   6.77609971]],

       [[ -3.01908027, -11.3799347 ,   2.99998956],
        [  2.9649046 , -10.94219321,   3.        ]],

       [[ -4.1299476 ,  -6.85150065,   6.77609971],
        [ -8.66223576,  -7.94598955,   2.99997378]],

       [[ -4.1299476 ,  -6.85150065,   6.77609971],
        [ -2.92529298, -11.95348622,   9.69453576]],

       [[ -4.1299476 ,  -6.85150065,   6.77609971],
        [ -7.64243428,  -3.07028432,   9.83621195]],

       [[ -4.1299476 ,  -6.85150065,   6.77609971],
        [ -8.02559453,  -8.97767107,  10.81382358]],

       [[-16.95341113,  -1.25770536,  19.53144718],
        [-16.18672605,  -5.19515853,  15.06956201]],

       [[ 16.44654381,   4.30239018,   2.99999997],
        [ 16.91678222,  -1.6789694 ,   2.99999998]],

       [[ 16.44654381,   4.30239018,   2.99999997],
        [ 13.92755096,   9.74779375,   2.99999562]],

       [[-14.61706738,  -8.67993573,   2.99997352],
        [ -8.66223576,  -7.94598955,   2.99997378]],

       [[-14.61706738,  -8.67993573,   2.99997352],
        [-12.31035328, -11.72412973,   7.62725827]],

       [[-14.61706738,  -8.67993573,   2.99997352],
        [-13.35408483,  -3.10425045,   4.82083444]],

       [[-10.02830201,   9.7683386 ,   2.99999327],
        [ -5.76500836,   5.54653762,   2.99999996]],

       [[-10.02830201,   9.7683386 ,   2.99999327],
        [-15.4249899 ,   7.14628414,   3.        ]],

       [[  5.02269578, -12.2507544 ,  18.48310629],
        [  1.57275094, -16.92707595,  16.98988258]],

       [[-13.30365665,  -6.26844524,   9.91829197],
        [-12.31035328, -11.72412973,   7.62725827]],

       [[-13.30365665,  -6.26844524,   9.91829197],
        [-16.18672605,  -5.19515853,  15.06956201]],

       [[-13.30365665,  -6.26844524,   9.91829197],
        [ -8.02559453,  -8.97767107,  10.81382358]],

       [[-13.30365665,  -6.26844524,   9.91829197],
        [-13.35408483,  -3.10425045,   4.82083444]],

       [[-13.30365665,  -6.26844524,   9.91829197],
        [-10.17978744,  -5.17242588,  14.9222936 ]],

       [[-13.30365665,  -6.26844524,   9.91829197],
        [-12.94948488, -11.01411661,  13.57239039]],

       [[ -4.49078755,  16.39612108,   8.32402814],
        [ -7.36047008,  15.32394817,  13.48303517]],

       [[ -4.49078755,  16.39612108,   8.32402814],
        [ -4.99624093,  10.43072628,   8.72208749]],

       [[ -4.49078755,  16.39612108,   8.32402814],
        [  1.03774526,  14.19514744,   7.55525763]],

       [[-16.03183261,   5.65511651,  15.99421782],
        [-16.31802697,   4.76680302,  10.06725706]],

       [[-16.03183261,   5.65511651,  15.99421782],
        [-13.96447423,   0.31574101,  14.19994656]],

       [[-16.03183261,   5.65511651,  15.99421782],
        [-13.5816345 ,  10.22444138,  19.01378346]],

       [[ -3.12919191,  -7.36261898,  13.88249446],
        [ -8.02559453,  -8.97767107,  10.81382358]],

       [[ -3.12919191,  -7.36261898,  13.88249446],
        [ -2.03700782, -11.95916951,  17.5809897 ]],

       [[ -7.98369105,   0.51055299,  14.63838405],
        [ -7.53696626,  -2.68218524,  19.69870163]],

       [[ -7.98369105,   0.51055299,  14.63838405],
        [ -7.64243428,  -3.07028432,   9.83621195]],

       [[ -7.98369105,   0.51055299,  14.63838405],
        [-13.96447423,   0.31574101,  14.19994656]],

       [[ -7.98369105,   0.51055299,  14.63838405],
        [-10.35078963,   5.99602419,  14.08495772]],

       [[-16.31802697,   4.76680302,  10.06725706],
        [-11.55129759,   1.35760375,   8.78069284]],

       [[  6.65362643,  -9.27892064,  10.96955585],
        [  1.97407908, -12.34633822,  13.13564619]],

       [[  2.18499271,   7.69583061,  13.5859831 ],
        [ -1.05781983,  10.25182691,  17.93925947]],

       [[  2.18499271,   7.69583061,  13.5859831 ],
        [  0.41630528,   7.98916117,   7.86010585]],

       [[-16.94697504,   1.3425533 ,   2.99997705],
        [-13.35408483,  -3.10425045,   4.82083444]],

       [[-16.94697504,   1.3425533 ,   2.99997705],
        [-15.4249899 ,   7.14628414,   3.        ]],

       [[-16.94697504,   1.3425533 ,   2.99997705],
        [-11.15716839,   2.91575186,   2.99999045]],

       [[  6.73706472, -15.60807988,   2.99998973],
        [  2.9649046 , -10.94219321,   3.        ]],

       [[ -3.28616088,  11.01018088,   2.99999997],
        [ -5.76500836,   5.54653762,   2.99999996]],

       [[ -3.28616088,  11.01018088,   2.99999997],
        [  2.70333359,  10.66289136,   2.99999843]],

       [[ -3.28616088,  11.01018088,   2.99999997],
        [ -4.99624093,  10.43072628,   8.72208749]],

       [[  5.70751108,  -5.60573823,   3.        ],
        [  2.9649046 , -10.94219321,   3.        ]],

       [[  5.70751108,  -5.60573823,   3.        ],
        [ 11.02958207,  -2.83541693,   2.99992164]],

       [[  8.14722072,   8.1412065 ,   2.99999997],
        [  6.16173294,   9.60753737,   8.46908047]],

       [[  8.14722072,   8.1412065 ,   2.99999997],
        [ 13.92755096,   9.74779375,   2.99999562]],

       [[  8.14722072,   8.1412065 ,   2.99999997],
        [  2.70333359,  10.66289136,   2.99999843]],

       [[ 16.91678222,  -1.6789694 ,   2.99999998],
        [ 11.02958207,  -2.83541693,   2.99992164]],

       [[ 16.91678222,  -1.6789694 ,   2.99999998],
        [ 15.27997932,  -7.45133547,   3.        ]],

       [[-16.95709662,  -1.20708254,   9.22750983],
        [-11.55129759,   1.35760375,   8.78069284]],

       [[-16.95709662,  -1.20708254,   9.22750983],
        [-13.96447423,   0.31574101,  14.19994656]],

       [[-16.95709662,  -1.20708254,   9.22750983],
        [-13.35408483,  -3.10425045,   4.82083444]],

       [[ -7.53696626,  -2.68218524,  19.69870163],
        [-10.17978744,  -5.17242588,  14.9222936 ]],

       [[ -8.66223576,  -7.94598955,   2.99997378],
        [ -8.89344566, -13.94150993,   2.99999657]],

       [[ -5.76500836,   5.54653762,   2.99999996],
        [ -6.52362641,   4.63057657,   8.88094327]],

       [[ -5.76500836,   5.54653762,   2.99999996],
        [-11.15716839,   2.91575186,   2.99999045]],

       [[ -2.92529298, -11.95348622,   9.69453576],
        [  0.32468059, -16.9968931 ,   9.72209765]],

       [[ -2.92529298, -11.95348622,   9.69453576],
        [ -8.07185302, -14.96144604,  10.37584618]],

       [[ -2.92529298, -11.95348622,   9.69453576],
        [  1.97407908, -12.34633822,  13.13564619]],

       [[ -7.36047008,  15.32394817,  13.48303517],
        [ -7.57242693,  10.45504375,  16.982859  ]],

       [[ -7.36047008,  15.32394817,  13.48303517],
        [ -9.95740314,  13.77861176,   8.29962558]],

       [[ -7.36047008,  15.32394817,  13.48303517],
        [ -3.54963885,  16.62528388,  17.93096005]],

       [[  0.32468059, -16.9968931 ,   9.72209765],
        [ -3.70259102, -16.59188926,  14.15116005]],

       [[  0.32468059, -16.9968931 ,   9.72209765],
        [  1.97407908, -12.34633822,  13.13564619]],

       [[-12.31035328, -11.72412973,   7.62725827],
        [ -8.07185302, -14.96144604,  10.37584618]],

       [[ -3.70259102, -16.59188926,  14.15116005],
        [ -8.07185302, -14.96144604,  10.37584618]],

       [[ -3.70259102, -16.59188926,  14.15116005],
        [  1.57275094, -16.92707595,  16.98988258]],

       [[ -3.70259102, -16.59188926,  14.15116005],
        [ -2.03700782, -11.95916951,  17.5809897 ]],

       [[ -3.70259102, -16.59188926,  14.15116005],
        [ -8.89258768, -14.48868115,  16.30523744]],

       [[ -7.64243428,  -3.07028432,   9.83621195],
        [-11.55129759,   1.35760375,   8.78069284]],

       [[ -7.64243428,  -3.07028432,   9.83621195],
        [ -8.02559453,  -8.97767107,  10.81382358]],

       [[  6.16173294,   9.60753737,   8.46908047],
        [  6.82755214,  15.56870414,   8.32431602]],

       [[  6.16173294,   9.60753737,   8.46908047],
        [  0.41630528,   7.98916117,   7.86010585]],

       [[ 16.50943786,  -4.05443831,  15.50046372],
        [ 14.43651983,  -8.97701706,  12.76713348]],

       [[ -7.57242693,  10.45504375,  16.982859  ],
        [-10.35078963,   5.99602419,  14.08495772]],

       [[-11.55129759,   1.35760375,   8.78069284],
        [ -6.52362641,   4.63057657,   8.88094327]],

       [[-11.55129759,   1.35760375,   8.78069284],
        [-11.15716839,   2.91575186,   2.99999045]],

       [[-13.96447423,   0.31574101,  14.19994656],
        [-11.9547322 ,   2.62374511,  19.36076173]],

       [[-12.47699595,  11.5466284 ,  13.26647895],
        [-13.5816345 ,  10.22444138,  19.01378346]],

       [[-12.47699595,  11.5466284 ,  13.26647895],
        [ -9.95740314,  13.77861176,   8.29962558]],

       [[-12.47699595,  11.5466284 ,  13.26647895],
        [-10.35078963,   5.99602419,  14.08495772]],

       [[ -8.07185302, -14.96144604,  10.37584618],
        [ -8.02559453,  -8.97767107,  10.81382358]],

       [[ -8.02559453,  -8.97767107,  10.81382358],
        [-10.17978744,  -5.17242588,  14.9222936 ]],

       [[ -8.02559453,  -8.97767107,  10.81382358],
        [-12.94948488, -11.01411661,  13.57239039]],

       [[  2.70333359,  10.66289136,   2.99999843],
        [  0.41630528,   7.98916117,   7.86010585]],

       [[  2.70333359,  10.66289136,   2.99999843],
        [  1.03774526,  14.19514744,   7.55525763]],

       [[  1.57275094, -16.92707595,  16.98988258],
        [  1.97407908, -12.34633822,  13.13564619]],

       [[ -2.03700782, -11.95916951,  17.5809897 ],
        [  1.97407908, -12.34633822,  13.13564619]],

       [[ -9.95740314,  13.77861176,   8.29962558],
        [ -4.99624093,  10.43072628,   8.72208749]],

       [[ -6.52362641,   4.63057657,   8.88094327],
        [ -4.99624093,  10.43072628,   8.72208749]],

       [[ -1.05781983,  10.25182691,  17.93925947],
        [ -1.70028906,  13.31727169,  12.82142327]],

       [[ 11.02958207,  -2.83541693,   2.99992164],
        [  7.74183567,  -2.01593629,   7.95160934]],

       [[ -8.89258768, -14.48868115,  16.30523744],
        [-12.94948488, -11.01411661,  13.57239039]],

       [[ -4.99624093,  10.43072628,   8.72208749],
        [ -1.70028906,  13.31727169,  12.82142327]],

       [[ -4.99624093,  10.43072628,   8.72208749],
        [  0.41630528,   7.98916117,   7.86010585]],

       [[-14.09149315,  -9.50945966,  19.26727187],
        [-12.94948488, -11.01411661,  13.57239039]],

       [[ -1.70028906,  13.31727169,  12.82142327],
        [  1.03774526,  14.19514744,   7.55525763]],

       [[  6.82755214,  15.56870414,   8.32431602],
        [  1.03774526,  14.19514744,   7.55525763]]])
        
 
coord_of_cylinders_walls = np.array([[[ -4.3057871 , -16.44566979,   5.94658009],
        [ -5.14161657, -19.63806531,   5.94658009]],

       [[ 11.8620403 ,  12.17752041,   8.2868275 ],
        [ 14.16467164,  14.541392  ,   8.2868275 ]],

       [[ 11.73970559, -12.29549696,   3.        ],
        [ 14.01858988, -14.68227018,   3.        ]],

       [[  8.62117414, -14.65180552,  14.32550003],
        [ 10.29469604, -17.49597929,  14.32550003]],

       [[ 15.35372183,   7.29816363,   8.28821361],
        [ 18.33415036,   8.71486606,   8.28821361]],

       [[ -1.77173227,  16.90742293,   2.99999842],
        [ -2.11565678,  20.18945217,   2.99999842]],

       [[  6.16408739, -15.84311768,   8.96791969],
        [  7.3606448 , -18.91854454,   8.96791969]],

       [[ -7.54889698,  15.23203519,   2.99998302],
        [ -9.01426922,  18.18883823,   2.99998302]],

       [[  4.21230051,  16.46987254,   2.99999897],
        [  5.02998212,  19.66696447,   2.99999897]],

       [[  0.89518832, -16.97641445,   3.        ],
        [  1.06896016, -20.27183602,   3.        ]],

       [[ 16.23026496,  -5.05752891,   8.59333012],
        [ 19.38084526,  -6.03928436,   8.59333012]],

       [[ 11.27688098, -12.72135431,   9.3035465 ],
        [ 13.46591917, -15.19078983,   9.3035465 ]],

       [[-16.95341113,  -1.25770536,  19.53144718],
        [-20.24436757,  -1.50184817,  19.53144718]],

       [[ 16.44654381,   4.30239018,   2.99999997],
        [ 19.63911171,   5.13756096,   2.99999997]],

       [[-14.61706738,  -8.67993573,   2.99997352],
        [-17.45449839, -10.36486459,   2.99997352]],

       [[ -4.49078755,  16.39612108,   8.32402814],
        [ -5.36252872,  19.57889775,   8.32402814]],

       [[-16.03183261,   5.65511651,  15.99421782],
        [-19.14389424,   6.75287442,  15.99421782]],

       [[-16.31802697,   4.76680302,  10.06725706],
        [-19.48564169,   5.69212294,  10.06725706]],

       [[  9.67161398,  13.98069671,   2.99999891],
        [ 11.54904494,  16.69459667,   2.99999891]],

       [[-16.94697504,   1.3425533 ,   2.99997705],
        [-20.23666823,   1.6031655 ,   2.99997705]],

       [[  6.73706472, -15.60807988,   2.99998973],
        [  8.04484742, -18.63788258,   2.99998973]],

       [[ 16.91678222,  -1.6789694 ,   2.99999998],
        [ 20.2006483 ,  -2.00488899,   2.99999998]],

       [[-16.95709662,  -1.20708254,   9.22750983],
        [-20.24876732,  -1.44139849,   9.22750983]],

       [[ -7.36047008,  15.32394817,  13.48303517],
        [ -8.78926744,  18.29859741,  13.48303517]],

       [[ 16.98672304,   0.67204506,  10.20559811],
        [ 20.28414344,   0.80250078,  10.20559811]],

       [[  0.32468059, -16.9968931 ,   9.72209765],
        [  0.38770684, -20.29629118,   9.72209765]],

       [[-12.31035328, -11.72412973,   7.62725827],
        [-14.70001003, -13.99999015,   7.62725827]],

       [[ -3.70259102, -16.59188926,  14.15116005],
        [ -4.42132931, -19.81266794,  14.15116005]],

       [[ 16.50943786,  -4.05443831,  15.50046372],
        [ 19.71421104,  -4.84147632,  15.50046372]],

       [[-12.47699595,  11.5466284 ,  13.26647895],
        [-14.89900081,  13.78803252,  13.26647895]],

       [[ -8.07185302, -14.96144604,  10.37584618],
        [ -9.638743  , -17.86572836,  10.37584618]],

       [[-16.18672605,  -5.19515853,  15.06956201],
        [-19.32885646,  -6.20363088,  15.06956201]],

       [[ 13.92755096,   9.74779375,   2.99999562],
        [ 16.63115235,  11.64002511,   2.99999562]],

       [[ 14.43651983,  -8.97701706,  12.76713348],
        [ 17.23890339, -10.71961467,  12.76713348]],

       [[  1.57275094, -16.92707595,  16.98988258],
        [  1.87804995, -20.21292326,  16.98988258]],

       [[-13.5816345 ,  10.22444138,  19.01378346],
        [-16.21806944,  12.2091859 ,  19.01378346]],

       [[ -9.95740314,  13.77861176,   8.29962558],
        [-11.89031074,  16.45328336,   8.29962558]],

       [[-15.4249899 ,   7.14628414,   3.        ],
        [-18.41925425,   8.53350475,   3.        ]],

       [[ -3.54963885,  16.62528388,  17.93096005],
        [ -4.2386864 ,  19.85254487,  17.93096005]],

       [[ -8.89258768, -14.48868115,  16.30523744],
        [-10.61879589, -17.30118986,  16.30523744]],

       [[ 13.72905649,  10.02561693,  13.56731481],
        [ 16.3941087 ,  11.97176614,  13.56731481]],

       [[-14.09149315,  -9.50945966,  19.26727187],
        [-16.82690063, -11.35541359,  19.26727187]],

       [[ 15.27997932,  -7.45133547,   3.        ],
        [ 18.24609209,  -8.89777076,   3.        ]],

       [[-12.94948488, -11.01411661,  13.57239039],
        [-15.46320875, -13.15215129,  13.57239039]],

       [[  6.82755214,  15.56870414,   8.32431602],
        [  8.15290046,  18.59086427,   8.32431602]]])


coord_of_cylinders_cavity = np.array([[[  1.67125622,  -7.8234882 ,   7.95986178],
        [  0.98186338,  -4.59630096,   7.95986178]],

       [[  3.61456488,  -7.13686467,  15.6786228 ],
        [  2.1235559 ,  -4.19290607,  15.6786228 ]],

       [[ -7.7415133 ,  -2.01708643,   2.99997758],
        [ -4.54813073,  -1.18503611,   2.99997758]],

       [[ -6.41463757,   4.78042051,  18.55069553],
        [ -3.76859948,   2.80849698,  18.55069553]],

       [[  7.70339383,   2.15791895,   2.99998372],
        [  4.52571634,   1.26776967,   2.99998372]],

       [[ -4.1299476 ,  -6.85150065,   6.77609971],
        [ -2.42633794,  -4.02524622,   6.77609971]],

       [[ -3.12919191,  -7.36261898,  13.88249446],
        [ -1.83840025,  -4.32553866,  13.88249446]],

       [[ -7.98369105,   0.51055299,  14.63838405],
        [ -4.69041816,   0.29994986,  14.63838405]],

       [[  2.18499271,   7.69583061,  13.5859831 ],
        [  1.28368323,   4.52130053,  13.5859831 ]],

       [[  5.70751108,  -5.60573823,   3.        ],
        [  3.35316246,  -3.29337092,   3.        ]],

       [[ -7.53696626,  -2.68218524,  19.69870163],
        [ -4.42796714,  -1.57578364,  19.69870163]],

       [[ -5.76500836,   5.54653762,   2.99999996],
        [ -3.38693128,   3.25858014,   2.99999996]],

       [[  7.82747297,   1.65247311,  15.00947987],
        [  4.59864038,   0.97082796,  15.00947987]],

       [[ -6.52362641,   4.63057657,   8.88094327],
        [ -3.83262927,   2.72046285,   8.88094327]],

       [[  7.74183567,  -2.01593629,   7.95160934],
        [  4.54832892,  -1.18436269,   7.95160934]],

       [[  0.41630528,   7.98916117,   7.86010585],
        [  0.24457936,   4.69363235,   7.86010585]]])



coord_of_cylinders_bottom = np.array([[[ 11.73970559, -12.29549696,   3.        ],
        [ 11.73970559, -12.29549696,  -0.3       ]],

       [[ -1.77173227,  16.90742293,   2.99999842],
        [ -1.77173227,  16.90742293,  -0.30000158]],

       [[ -7.7415133 ,  -2.01708643,   2.99997758],
        [ -7.7415133 ,  -2.01708643,  -0.30002242]],

       [[ -7.54889698,  15.23203519,   2.99998302],
        [ -7.54889698,  15.23203519,  -0.30001698]],

       [[  4.21230051,  16.46987254,   2.99999897],
        [  4.21230051,  16.46987254,  -0.30000103]],

       [[  0.89518832, -16.97641445,   3.        ],
        [  0.89518832, -16.97641445,  -0.3       ]],

       [[  7.70339383,   2.15791895,   2.99998372],
        [  7.70339383,   2.15791895,  -0.30001628]],

       [[ -3.01908027, -11.3799347 ,   2.99998956],
        [ -3.01908027, -11.3799347 ,  -0.30001044]],

       [[ 16.44654381,   4.30239018,   2.99999997],
        [ 16.44654381,   4.30239018,  -0.30000003]],

       [[-14.61706738,  -8.67993573,   2.99997352],
        [-14.61706738,  -8.67993573,  -0.30002648]],

       [[-10.02830201,   9.7683386 ,   2.99999327],
        [-10.02830201,   9.7683386 ,  -0.30000673]],

       [[  9.67161398,  13.98069671,   2.99999891],
        [  9.67161398,  13.98069671,  -0.30000109]],

       [[-16.94697504,   1.3425533 ,   2.99997705],
        [-16.94697504,   1.3425533 ,  -0.30002295]],

       [[  6.73706472, -15.60807988,   2.99998973],
        [  6.73706472, -15.60807988,  -0.30001027]],

       [[ -3.28616088,  11.01018088,   2.99999997],
        [ -3.28616088,  11.01018088,  -0.30000003]],

       [[  5.70751108,  -5.60573823,   3.        ],
        [  5.70751108,  -5.60573823,  -0.3       ]],

       [[  8.14722072,   8.1412065 ,   2.99999997],
        [  8.14722072,   8.1412065 ,  -0.30000003]],

       [[ 16.91678222,  -1.6789694 ,   2.99999998],
        [ 16.91678222,  -1.6789694 ,  -0.30000002]],

       [[  2.9649046 , -10.94219321,   3.        ],
        [  2.9649046 , -10.94219321,  -0.3       ]],

       [[ -8.66223576,  -7.94598955,   2.99997378],
        [ -8.66223576,  -7.94598955,  -0.30002622]],

       [[ -5.76500836,   5.54653762,   2.99999996],
        [ -5.76500836,   5.54653762,  -0.30000004]],

       [[ 13.92755096,   9.74779375,   2.99999562],
        [ 13.92755096,   9.74779375,  -0.30000438]],

       [[  2.70333359,  10.66289136,   2.99999843],
        [  2.70333359,  10.66289136,  -0.30000157]],

       [[-15.4249899 ,   7.14628414,   3.        ],
        [-15.4249899 ,   7.14628414,  -0.3       ]],

       [[-11.15716839,   2.91575186,   2.99999045],
        [-11.15716839,   2.91575186,  -0.30000955]],

       [[ 11.02958207,  -2.83541693,   2.99992164],
        [ 11.02958207,  -2.83541693,  -0.30007836]],

       [[ 15.27997932,  -7.45133547,   3.        ],
        [ 15.27997932,  -7.45133547,  -0.3       ]],

       [[ -8.89344566, -13.94150993,   2.99999657],
        [ -8.89344566, -13.94150993,  -0.30000343]]])

        
for u in range(len(coord_of_cylinders)):
#	for p in range(len(coord_of_cylinders[u]["x"])):
	p1 = geompy.MakeVertex(coord_of_cylinders[u][0][0], coord_of_cylinders[u][0][1], coord_of_cylinders[u][0][2])	
	p2 = geompy.MakeVertex(coord_of_cylinders[u][1][0], coord_of_cylinders[u][1][1], coord_of_cylinders[u][1][2])	
	u = geompy.MakeVector(p1, p2)	
	c = geompy.MakeCylinder(p1, u, r_c, h_c)
	s1 = geompy.MakeSpherePntR(p1, radius)
	s2 = geompy.MakeSpherePntR(p2, radius)
	cu =  geompy.MakeCutList(c, [s1,s2])
	geompy.addToStudy(cu, "Cylinder_cutted" + str(u))


for u in range(len(coord_of_cylinders_walls)) :
	p1 = geompy.MakeVertex(coord_of_cylinders_walls[u][0][0], coord_of_cylinders_walls[u][0][1], coord_of_cylinders_walls[u][0][2])	
	p2 = geompy.MakeVertex(coord_of_cylinders_walls[u][1][0], coord_of_cylinders_walls[u][1][1], coord_of_cylinders_walls[u][1][2])	
	vv = geompy.MakeVector(p1, p2)	
	c = geompy.MakeCylinder(p1, vv, r_c, h_c)
	s1 = geompy.MakeSpherePntR(p1, radius)
	s1_common = geompy.MakeCommon(s1, cylinder)
	common_s_w = geompy.MakeCommon(c, cylinder)
	cut_cylinder = geompy.MakeCut(common_s_w, s1_common)
	geompy.addToStudy(cut_cylinder, "Sphere_wall_bridge" + str(u))

	
	
for u in range(len(coord_of_cylinders_cavity)) :
	p1 = geompy.MakeVertex(coord_of_cylinders_cavity[u][0][0], coord_of_cylinders_cavity[u][0][1], coord_of_cylinders_cavity[u][0][2])	
	p2 = geompy.MakeVertex(coord_of_cylinders_cavity[u][1][0], coord_of_cylinders_cavity[u][1][1], coord_of_cylinders_cavity[u][1][2])	
	vv = geompy.MakeVector(p1, p2)	
	c = geompy.MakeCylinder(p1, vv, r_c, h_c)
	s1 = geompy.MakeSpherePntR(p1, radius)
#	s1_common = geompy.MakeCommon(s1, cylinder_small)
#	common_s_w = geompy.MakeCommon(c, cylinder_small)
	cu =  geompy.MakeCutList(c, [s1, cylinder_small])
#	cut_cylinder = geompy.MakeCut(common_s_w, s1_common)
	geompy.addToStudy(cu, "Sphere_cavity_bridge" + str(u))	



for u in range(len(coord_of_cylinders_bottom)) :
	p1 = geompy.MakeVertex(coord_of_cylinders_bottom[u][0][0], coord_of_cylinders_bottom[u][0][1], coord_of_cylinders_bottom[u][0][2])	
	p2 = geompy.MakeVertex(coord_of_cylinders_bottom[u][1][0], coord_of_cylinders_bottom[u][1][1], coord_of_cylinders_bottom[u][1][2])	
	vv = geompy.MakeVector(p1, p2)	
	c = geompy.MakeCylinder(p1, vv, r_c, h_c)
	s1 = geompy.MakeSpherePntR(p1, radius)
	s1_common = geompy.MakeCommon(s1, cylinder)
	common_s_w = geompy.MakeCommon(c, cylinder)
	cut_cylinder = geompy.MakeCut(common_s_w, s1_common)
	geompy.addToStudy(cut_cylinder, "Sphere_bottom_bridge" + str(u))
